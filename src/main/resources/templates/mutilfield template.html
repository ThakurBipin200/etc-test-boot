<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Complex Form</title>
    <script>
        function addField() {
            var container = document.getElementById("siteOtherLangsContainer");
            var index = container.children.length; // Each field pair consists of one div element

            var fieldDiv = document.createElement("div");
            fieldDiv.setAttribute("id", "field-" + index);

            var label1 = document.createElement("label");
            label1.setAttribute("for", "siteOtherLang");
            label1.innerText = "Site's Other Language Path";

            var input1 = document.createElement("input");
            input1.type = "text";
            input1.name = "siteOtherLangs[" + index + "].siteOtherLang";
            input1.required = true;

            var label2 = document.createElement("label");
            label2.setAttribute("for", "langCode");
            label2.innerText = "Site's Other Language Code";

            var select2 = document.createElement("select");
            select2.name = "siteOtherLangs[" + index + "].langCode";
            select2.required = true;

            /* Assuming the list of language codes is available in a global variable 'languageCodes' */
            languageCodes.forEach(function(code) {
                var option = document.createElement("option");
                option.value = code;
                option.text = code;
                select2.appendChild(option);
            });

            var removeButton = document.createElement("button");
            removeButton.type = "button";
            removeButton.innerText = "Remove";
            removeButton.onclick = function() {
                removeField(fieldDiv.id);
            };

            fieldDiv.appendChild(label1);
            fieldDiv.appendChild(input1);
            fieldDiv.appendChild(label2);
            fieldDiv.appendChild(select2);
            fieldDiv.appendChild(removeButton);
            container.appendChild(fieldDiv);
        }

        function removeField(id) {
            var field = document.getElementById(id);
            field.parentNode.removeChild(field);
        }
    </script>
</head>
<body>
<script>
    var languageCodes = /*[[${languageCodes}]]*/ [];
</script>
<form th:action="@{/submit}" th:object="${multiFieldForm}" method="post">
    <div id="siteOtherLangsContainer">
        <div th:each="siteOtherLang, stat : *{siteOtherLangs}" th:id="|'field-' + ${stat.index}|">
            <label for="siteOtherLang">Site's Other Language Path</label>
            <input type="text" th:field="*{siteOtherLangs[stat.index].siteOtherLang}" required>
            <label for="langCode">Site's Other Language Code</label>
            <select th:field="*{siteOtherLangs[stat.index].langCode}" required>
                <option th:each="code : ${languageCodes}" th:value="${code}" th:text="${code}"></option>
            </select>
            <button type="button" onclick="removeField('field-[[${stat.index}]]')">Remove</button>
        </div>
        <div th:if="${#lists.isEmpty(multiFieldForm.siteOtherLangs)}" id="field-0">
            <label for="siteOtherLang">Site's Other Language Path</label>
            <input type="text" th:field="*{siteOtherLangs[0].siteOtherLang}" required>
            <label for="langCode">Site's Other Language Code</label>
            <select th:field="*{siteOtherLangs[0].langCode}" required>
                <option th:each="code : ${languageCodes}" th:value="${code}" th:text="${code}"></option>
            </select>
            <button type="button" onclick="removeField('field-0')">Remove</button>
        </div>
    </div>

    <button type="button" onclick="addField()">Add Field</button>
    <button type="submit">Submit</button>
</form>
</body>
</html>
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dispatcher Configuration Setup</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div class="form-container">
        <h2>Dispatcher Configuration Setup</h2>
        <div>
            <p>All fields should be in lowercase</p>
        </div>
        <form action="#" th:action="@{/generate-config}" th:object="${siteConfig}" method="post" id="download-form">
            <!-- Existing fields... -->

            <!-- Language Configurations -->
            <div id="siteOtherLanguageContainer">
                <div class="dummyDiv" th:each="langConfig, iterStat : *{languageConfigs}">
                    <div class="siteContainer">
                        <label for="siteOtherLang">Site's Other Language Path <span th:text="${iterStat.index + 1}">1</span>*</label>
                        <div class="tooltip" tabindex="0" title="A ZIP code helps us find plans in your area" aria-hidden="false" aria-describedby="TooltipDef">
                            <img alt="" src="css/assets/tooltip.svg">
                            <span id="TooltipDef" role="tooltip" class="tooltiptext hide" aria-label="A ZIP code helps us find plans in your area.">A ZIP code.</span>
                        </div>
                        <input type="text" th:field="*{languageConfigs[__${iterStat.index}__].siteOtherLang}" id="siteOtherLang" name="siteOtherLang" required>
                    </div>
                    <div class="siteContainer">
                        <div class="tooltip" tabindex="0" title="A ZIP code helps us find plans in your area" aria-hidden="false" aria-describedby="TooltipDef">
                            <label for="langCode">Site's Other Language Code <span th:text="${iterStat.index + 1}">1</span>*</label>
                            <img alt="" src="css/assets/tooltip.svg">
                            <span id="TooltipDef" role="tooltip" class="tooltiptext hide" aria-label="A ZIP code helps us find plans in your area.">A ZIP code.</span>
                        </div>
                        <select th:field="*{languageConfigs[__${iterStat.index}__].langCode}" id="langCode" name="langCode" required>
                            <option value="en" class="langCodeOption">English</option>
                            <option value="es" class="langCodeOption">Español</option>
                            <option value="fr" class="langCodeOption">Français</option>
                            <option value="de" class="langCodeOption">Deutsch</option>
                            <option value="it" class="langCodeOption">Italiano</option>
                            <option value="pt" class="langCodeOption">Português</option>
                        </select>
                    </div>
                    <button type="button" th:if="${iterStat.index > 0}" onclick="removeLanguageConfig(this)">Remove</button>
                </div>
            </div>

            <button type="button" onclick="addLanguageConfig()">Add Language Configuration</button>

            <!-- Existing fields... -->

            <button type="submit">Generate Config</button>
        </form>
    </div>

    <script>
        const languageCodes = ["en", "es", "fr", "de", "it", "pt"]; // Update with the same list of language codes
        let options = languageCodes.map(code => `<option value="${code}">${code}</option>`).join('');

        function addLanguageConfig() {
            const container = document.getElementById('siteOtherLanguageContainer');
            const index = container.children.length;
            const newConfig = document.createElement('div');
            newConfig.className = 'dummyDiv';

            newConfig.innerHTML = `
                <div class="siteContainer">
                    <label for="siteOtherLang">Site's Other Language Path ${index + 1}*</label>
                    <div class="tooltip" tabindex="0" title="A ZIP code helps us find plans in your area" aria-hidden="false" aria-describedby="TooltipDef">
                        <img alt="" src="css/assets/tooltip.svg">
                        <span id="TooltipDef" role="tooltip" class="tooltiptext hide" aria-label="A ZIP code helps us find plans in your area.">A ZIP code.</span>
                    </div>
                    <input type="text" name="languageConfigs[${index}].siteOtherLang" required>
                </div>
                <div class="siteContainer">
                    <div class="tooltip" tabindex="0" title="A ZIP code helps us find plans in your area" aria-hidden="false" aria-describedby="TooltipDef">
                        <label for="langCode">Site's Other Language Code ${index + 1}*</label>
                        <img alt="" src="css/assets/tooltip.svg">
                        <span id="TooltipDef" role="tooltip" class="tooltiptext hide" aria-label="A ZIP code helps us find plans in your area.">A ZIP code.</span>
                    </div>
                    <select name="languageConfigs[${index}].langCode" required>
                        ${options}
                    </select>
                </div>
                <button type="button" onclick="removeLanguageConfig(this)">Remove</button>
            `;

            container.appendChild(newConfig);
        }

        function removeLanguageConfig(button) {
            const container = document.getElementById('siteOtherLanguageContainer');
            container.removeChild(button.parentElement);
        }
    </script>
</body>
</html>

